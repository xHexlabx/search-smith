[cite_start]The 18th National Computer Olympiad examination, held at Chiang Mai University, presents problem number 3 out of 3. The exam took place on Thursday, June 2, 2565 BE (2022 CE), from 09:00 to 12:00. [cite: 2]

[cite_start]The problem is titled "Constellation". [cite: 2]

Historically, there was an ancient belief that the establishment or construction of a city should be done at an auspicious time. Since the founding of Chiang Mai in 1839 BE, rulers and citizens alike have participated in the "Sueb Chata Mueang" ceremony. This royal ceremony is believed to extend the city's lifespan, ensuring its continued existence and bringing happiness and prosperity to its people. [cite_start]According to Lanna beliefs, the Sueb Chata Mueang ceremony is performed for the peace and well-being of the city, especially when the city experiences distress due to the influence of planetary alignments causing chaos and unrest. [cite: 2]

[cite_start]General information about Chiang Mai province, as stated in the Chiang Mai summary document, indicates that traditional activities in June include the Sueb Chata Mueang ceremony held at five city gates (Suan Dok Gate, Saen Pung Gate (also known as Suan Pung Gate), Chang Phuak Gate (originally Hua Wiang Gate), Tha Phae Gate, and Chiang Mai Gate) and the four city corners ("Jaeng" is a Northern Thai dialect word for corner) in Mueang District, Chiang Mai Province. [cite: 2] [cite_start]Therefore, the consideration of "Constellation," which refers to a group of stars, might become part of the Chiang Mai Sueb Chata Mueang ceremony in the future. [cite: 2]

[cite_start]The problem defines a constellation as a group of K stars, where $K \ge 2$. [cite: 4] [cite_start]The sky is represented by a two-dimensional grid of R rows and C columns. [cite: 3] [cite_start]Each cell in the grid contains either "." or "#". [cite: 3] [cite_start]A "." signifies an empty space in the sky, while a "#" represents a star. [cite: 4]

[cite_start]The center of a constellation can be any cell in the grid, regardless of whether it contains a star. [cite: 4] [cite_start]Stars that are an equal distance from the center are considered to be part of the same constellation. [cite: 4] [cite_start]The distance is measured as the sum of the absolute differences in row and column coordinates (Manhattan distance), not diagonally, and the distance must always be a positive integer. [cite: 4] [cite_start]Different center points that result in the same constellation pattern on the sky are counted as distinct constellations, even if the patterns overlap. [cite: 4] [cite_start]The task for contestants of TOI-18 at Chiang Mai University is to write a program to count the number of constellations in a given sky map. [cite: 4]

**Example 1:**
[cite_start]Consider finding constellations of size $K=2$ from the following $R=3, C=2$ grid with 3 stars at (1,1), (2,2), and (3,1): [cite: 5, 6]

(r,c) | (r,1) | (r,2)
---|---|---
(1,c) | # | .
(2,c) | . | #
(3,c) | # | .

Using "*" to denote the center of a constellation:

If the distance is 1:
* [cite_start]Center at (1,2): 1 constellation [cite: 6]
    # .
    . #
    # .
* [cite_start]Center at (2,1): 3 constellations [cite: 7]
    . # .
    # # #
    . # .
* [cite_start]Center at (3,2): 1 constellation [cite: 8]
    # .
    . #
    # .

If the distance is 2:
* [cite_start]Center at (1,1): 1 constellation [cite: 9]
    # .
    . #
    # .
* [cite_start]Center at (2,2): 1 constellation [cite: 9]
    # .
    . #
    # .
* [cite_start]Center at (3,1): 1 constellation [cite: 9]
    # .
    . #
    # .

[cite_start]If the distance is greater than 2, no more constellations can be found (0 constellations). [cite: 9]
[cite_start]For the given grid and $K=2$, there are a total of 8 constellations. [cite: 9]

**Example 2:**
[cite_start]Consider finding constellations of size $K=3$ from the following $R=3, C=2$ grid with 4 stars: [cite: 10, 11]

(r,c) | (r,1) | (r,2)
---|---|---
(1,c) | # | .
(2,c) | . | #
(3,c) | # | #

[cite_start]There is only one such constellation: when the center is at (2,1) and the distance is 1. [cite: 11]
# .
* #
# #
[cite_start]For the given grid and $K=3$, there is a total of 1 constellation. [cite: 11]

**Problem Statement:**
[cite_start]Given a sky map grid and a constellation size K, write an efficient program to output the remainder after dividing the total number of constellations of size K by 1,000,003. [cite: 11]
[cite_start]Note: Due to potential integer overflow issues, the result must be given modulo the prime number 1,000,003. [cite: 11]

**Input:**
[cite_start]The input consists of $R+1$ lines[cite: 12]:
* [cite_start]Line 1: Three integers $R, C, K$ separated by spaces. [cite: 13]
    * [cite_start]$1 \le R, C \le 300$ [cite: 13]
    * [cite_start]$2 \le K \le 600$ [cite: 13]
    * [cite_start]$R$ is the number of rows and $C$ is the number of columns of the sky map. [cite: 13]
* [cite_start]Lines $i+1$ (for $i=1$ to $R$): Each line consists of a string of length C, containing only "." or "#" characters. [cite: 13]

**Output:**
The output consists of 1 line:
* [cite_start]Line 1: The remainder after dividing the total number of constellations of size K by 1,000,003. [cite: 15]

[cite_start]**Example 1 Input/Output:** [cite: 17]
Input:
3 2 2
#.
.#
#.
Output:
8

[cite_start]**Example 2 Input/Output:** [cite: 19]
Input:
3 3 2
#..
.#.
#..
Output:
11

[cite_start]**Example 3 Input/Output:** [cite: 21]
Input:
5 4 3
#.#.
#.#.
#.#.
#.#.
#.#.
Output:
240

[cite_start]**Example 4 Input/Output:** [cite: 24]
Input:
20 20 19
####################
####################
####################
... (17 more lines of '####################') ...
Output:
199545

[cite_start]**Constraints:** [cite: 26]
* Input: Standard Input (keyboard)
* Output: Standard Output (screen)
* Maximum processing time: 1 second
* Maximum memory usage: 1024MB
* Maximum score for the problem: 100 points
* Program execution condition: The program must compile successfully.

[cite_start]**Other Requirements:** [cite: 27]
Contestants must include the following program header:
```
/*
TASK: TaskName
AUTHOR: YourName YourLastName
CENTER: YourCenter
*/
```

[cite_start]**Additional Information about Test Cases:** [cite: 28]
| Group Test Case | Score | Condition |
|---|---|---|
| 1 | 15 points | $1 \le R, C \le 8$ |
| 2 | 12 points | Number of stars in the sky map $\le 18$ |
| 3 | 7 points | $K \le 5$ and $R=1$ and $K=2$ |
| 4 | 5 points | Only '#' characters are at coordinates (r,c) where r=c |
| 5 | 61 points | No other conditions |

[cite_start]**Programming Recommendations:** [cite: 30]
1.  If using `cin`/`cout`, it is recommended to add the following two lines:
    ```cpp
    std::ios_base::sync_with_stdio(false);
    std::cin.tie(NULL);
    ```
2.  If a, b, and n are positive integers, and $a+b$ does not exceed INT_MAX, then $(a+b)\%n$ is equal to $(a\%n + b\%n)\%n$.