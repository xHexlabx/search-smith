**ค่ายกลพิฆาตแมลงวัน (Fly)**

ฝูงแมลงวันต้องบินผ่านค่ายกลขนาดกว้าง C หน่วย ลึก R แถว เพื่อไปให้ถึงอาหาร
* แมลงวันแต่ละตัวจะบินตรงขึ้นไปตามแนวคอลัมน์ของตน
* ในแต่ละวินาที แมลงวันสามารถเลือกที่จะ "อยู่กับที่" หรือ "บินขึ้น" ไปยังแถวถัดไป 1 หน่วย
* แต่ละแถวมีกับดัก 2 อัน (ซ้าย-ขวา) เคลื่อนที่ในแนวนอนด้วยความเร็ว 1 หน่วย/วินาที และจะกระดอนเมื่อชนกันหรือชนขอบ
* แมลงวันจะตายถ้าอยู่ในตำแหน่งเดียวกับกับดัก

**งานของคุณ**

จงเขียนโปรแกรมคำนวณหาเวลาที่ "น้อยที่สุด" ที่แมลงวันตัวใดตัวหนึ่งสามารถบินผ่านค่ายกลไปได้

**ข้อมูลนำเข้า**

1.  **บรรทัดที่ 1** จำนวนเต็ม R (แถว, $1 \le R \le 2,000$) และ C (คอลัมน์, $1 \le C \le 2,000$)
2.  **R บรรทัดถัดไป** แต่ละบรรทัดมีข้อมูล 4 ค่า สำหรับกับดักในแต่ละแถว:
    * ตำแหน่งเริ่มต้นของกับดักซ้าย
    * ทิศทางเริ่มต้นของกับดักซ้าย ('L' หรือ 'R')
    * ตำแหน่งเริ่มต้นของกับดักขวา
    * ทิศทางเริ่มต้นของกับดักขวา

**ข้อมูลส่งออก**

เวลาที่น้อยที่สุดที่แมลงวันสามารถบินผ่านค่ายกลได้

**ตัวอย่างที่ 1**

| ข้อมูลนำเข้า | ข้อมูลส่งออก |
| :--- | :--- |
| 5 7 | 9 |
| 4 R 4 L | |
| 1 L 6 R | |
| 1 R 7 R | |
| 2 R 7 R | |
| 1 R 3 R | |